<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-nz" xml:lang="en-nz" class="_Skins_HTML5_Left_FIS" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="General System Information|Commodities in Quantum">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Expires" content="0" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Cache-Control" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The Average Commodity Price function</title>
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="Resources/Stylesheets/stylesheet.css" rel="stylesheet" />
        <script src="../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../Resources/Scripts/require.min.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/require.config.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/foundation.6.2.3_custom.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/plugins.min.js" defer="defer">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-left" role="navigation" id="offCanvas" data-off-canvas="" data-position="left" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1150px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-dropdown" style="display:none;" id="#centralSmallScreen"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="166520.htm" title="FIS" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                    <div class="central-dropdown" style="display:none;" id="#centralTop"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="central-dropdown" style="display:none;"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_bodytext_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="   &gt;   " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                        </div>
                                    </div>
                                    <div role="main" id="mc-main-content">
                                        <h1>The Average Commodity Price function</h1>
                                        <p class="bodytext">This is the function the system uses to price Commodity Swap and Commodity Exposure deals.</p>
                                        <p class="bodytext">In Analytics <em class="emphasis">Position</em> queries, you can apply this function (<strong class="boldcharstyle">AverageCommodityPrice</strong>) in a new or existing Calculated Column.</p>
                                        <p class="note-level-1-body"> This function is NOT currently supported for Cash Flow queries nor for any VaR queries.</p>
                                        <p class="bodytext">The function calculates an average price, over a specified date range, for a given Commodity, Currency, Measure, and Commodity Rate curve, and has the following syntax:</p>
                                        <p class="bodytext"><code class="monospace">AverageCommodityPrice</code>(<em class="emphasis">ccy</em>,<em class="emphasis">rate_name</em>,<em class="emphasis">basis_rate_name</em>,<em class="emphasis">commodity</em>,<em class="emphasis">measure</em>,<em class="emphasis">start_date</em>,<em class="emphasis">end_date</em>,<em class="emphasis">position_date</em>,<em class="emphasis">as_at_date</em>,<em class="emphasis">term</em>,<em class="emphasis">term_type</em>,<em class="emphasis">frequency</em>,<em class="emphasis">bdc</em>,<em class="emphasis">fixing_date</em>,<em class="emphasis">interpolation</em>,<em class="emphasis">period_average</em>,<em class="emphasis">method</em>,<em class="emphasis">bidoffermid</em>,<em class="emphasis">holiday_center1</em>|<em class="emphasis">holiday_center2</em>|...,<em class="emphasis">rounding</em>)</p>
                                        <p class="bodytext">
                                            <br />...where:</p>
                                        <ul class="listbullet1">
                                            <li class="listbullet1" value="1"><em class="emphasis">ccy</em> is the currency linked to the Commodity Rate to be averaged.</li>
                                            <li class="listbullet1" value="2"><em class="emphasis">rate_name</em> is the rate name which together with <em class="emphasis">ccy</em>, <em class="emphasis">measure</em>, and <em class="emphasis">commodity</em> determine the Commodity curve used in the calculation for <em class="emphasis">historical</em> points (up to <em class="emphasis">position_date</em>) and, if a rate is specified for it, on <em class="emphasis">position_date</em> also.</li>
                                            <li class="listbullet1" value="3"><em class="emphasis">basis_rate_name</em> is the rate name which together with <em class="emphasis">ccy</em>, <em class="emphasis">measure</em>, and <em class="emphasis">commodity</em> determine the Commodity curve used in the calculation for <em class="emphasis">forward</em> points (after <em class="emphasis">position_date</em>); if omitted, defaults to <em class="emphasis">rate_name</em>.</li>
                                            <li class="listbullet1" value="4"><em class="emphasis">commodity</em> is the commodity name linked to the Commodity Rate to be averaged.</li>
                                            <li class="listbullet1" value="5"><em class="emphasis">measure</em> is the measure name linked to the Commodity Rate to be averaged.</li>
                                            <li class="listbullet1" value="6"><em class="emphasis">start_date</em> is the start of the averaging period. The first rate record used in the calculation will have a Rate Date equal to or following this date<strong class="boldcharstyle">**</strong>.</li>
                                            <li class="listbullet1" value="7"><em class="emphasis">end_date</em> is the end of the averaging period. The last rate record used in the calculation will have a Rate Date equal to or preceding this date<strong class="boldcharstyle">**</strong>.</li>
                                            <li class="listbullet1" value="8"><em class="emphasis">position_date</em> is the date before which rates will be extracted from historical Commodity rate records, and after which Forward Rates will be interpolated from a single (last available) rate record.<p class="listcontinue">For dates on or before this date, the average of the Bid/Offer rates from each rate record will be extracted.</p><p class="listcontinue">For dates after this, the position date rate record will be used to interpolate Forward Rates at the same frequency. The last Forward Rate interpolated from this rate record will be that on or before the e<em class="emphasis">nd_date</em>.</p></li>
                                            <li class="listbullet1" value="9"><em class="emphasis">as_at_date</em> is the effective date that determines the "time slice" of the database - that is, the data used reflects the values in the database at that time.</li>
                                            <li class="listbullet1" value="10"><em class="emphasis">term</em> is zero or a positive integer that together with <em class="emphasis">term_type</em> gives the point on the Commodity Rate curve for selecting the rate to be averaged.</li>
                                            <li class="listbullet1" value="11"><em class="emphasis">term_type</em> is <strong class="boldcharstyle">Spot</strong>, <strong class="boldcharstyle">Overnight</strong>, <strong class="boldcharstyle">Tom Next</strong>, or a time unit (<strong class="boldcharstyle">Days</strong>, <strong class="boldcharstyle">Weeks</strong>, <strong class="boldcharstyle">Months</strong>, or <strong class="boldcharstyle">Years</strong>) that together with <em class="emphasis">term</em> gives the point on the Commodity Rate curve for selecting the rate to be averaged.</li>
                                            <li class="listbullet1" value="12"><em class="emphasis">frequency</em> is the frequency at which the rate will be averaged. Currently only <strong class="boldcharstyle">"DAILY"</strong> is supported.</li>
                                            <li class="listbullet1" value="13"><em class="emphasis">bdc</em> (Business Day Convention) determines which rate/forward date to select if the rate fixing falls on a non-business day (NBD): <strong class="boldcharstyle">A</strong> (Actual; the default), <strong class="boldcharstyle">F</strong> (Following), <strong class="boldcharstyle">MF</strong> (Modified Following*), or <strong class="boldcharstyle">P</strong> (Preceding). This convention will also apply to the <em class="emphasis">start_date</em>, <em class="emphasis">end_date</em>, and <em class="emphasis">position_date</em> arguments if any of these are set to a Non Business day.</li>
                                            <li class="listbullet1" value="14"><em class="emphasis">fixing_date</em> is not currently used and must be zero.</li>
                                            <li class="listbullet1" value="15"><em class="emphasis">interpolation</em> is the interpolation method between points: <strong class="boldcharstyle">"L"</strong> (Linear) or <strong class="boldcharstyle">"F"</strong> (Flat; the value at the end point).</li>
                                            <li class="listbullet1" value="16"><em class="emphasis">period_average</em> is not currently used and must be "<strong class="boldcharstyle">FULL"</strong>.</li>
                                            <li class="listbullet1" value="17"><em class="emphasis">method</em> is the type of average (mean) to apply to the extracted rates: <strong class="boldcharstyle">A</strong> (Arithmetic) or <strong class="boldcharstyle">G</strong> (Geometric).</li>
                                            <li class="listbullet1" value="18"><em class="emphasis">bidoffermid</em> is the average of the Bid and Offer values in the Rates grid row with the matching <em class="emphasis">term</em> and t<em class="emphasis">erm_type</em> settings and currently must be <strong class="boldcharstyle">"MID"</strong> (the only supported method).</li>
                                            <li class="listbullet1" value="19"><em class="emphasis">holiday_center1</em> | <em class="emphasis">holiday_center2</em> | ... give optional predefined Holiday Center identifiers of specific holiday calendars also to be applied, in tandem with the <em class="emphasis">bdc</em> value, to determine the behavior when <em class="emphasis">start_date</em>, <em class="emphasis">end_date</em>, <em class="emphasis">position_date</em>, or one of the averaging (fixing) dates falls on a holiday<strong class="boldcharstyle">**</strong>. Multiple identifier values must be separated by the pipe character <strong class="boldcharstyle">|</strong>.</li>
                                            <li class="listbullet1" value="20"><em class="emphasis">rounding</em> is the number of decimal places to round the result to, using the 5/4 method, with <strong class="boldcharstyle">-1</strong> indicating NO ROUNDING.</li>
                                        </ul>
                                        <p class="note-level-1-body"><strong class="boldcharstyle">**NOTE:</strong> If there is no rate for the Start Date and it is a holiday, the applicable Business Day Convention (BDC) will be ignored if it would adjust the Start Date to an <em class="emphasis">earlier</em> date; instead, the Start Date point is treated as missing rate and will not be included in the calculation.<br /><br />Similarly, if there is no rate for the End Date and it is a holiday, the applicable BDC will be ignored if it would adjust the End Date to an <em class="emphasis">later</em> date; instead, the End Date point is treated as missing rate and will not be included in the calculation.</p>
                                        <h3 class="h3internal">Examples and Results</h3>
                                        <p class="bodytext"><strong class="boldcharstyle">Example 1</strong>
                                        </p>
                                        <p class="bodytext"><code class="monospace">AverageCommodityPrice("USD", "LME Zinc Closing Daily Market Rates","LME Zinc Closing Comm" ,"Zinc", "Pound", QueryStartDate, QueryEndDate, QueryPositionDate, QueryAsAtDate, 0, "SPOT", "DAILY", "A", 0, "LINEAR", "FULL", "A", "MID", "United States", -1)</code>
                                        </p>
                                        <p class="bodytext">This example calculates the arithmetic mean price calculated from the <strong class="boldcharstyle">LME Zinc Closing Daily Market Rates</strong> and <strong class="boldcharstyle">LME Zinc Closing Comm</strong> records for a pound of Zinc in USD currency, using:</p>
                                        <ul class="listbullet1">
                                            <li class="listbullet1" value="1">the MID of Spot rates,</li>
                                            <li class="listbullet1" value="2">the United States Holiday Center,</li>
                                            <li class="listbullet1" value="3">the query's <strong class="boldcharstyle">As at Date</strong> as the Effective Date,</li>
                                            <li class="listbullet1" value="4">rates taken daily between the query's specified <strong class="boldcharstyle">Start Date</strong> and <strong class="boldcharstyle">End Date</strong>,</li>
                                            <li class="listbullet1" value="5">the <strong class="boldcharstyle">Actual</strong> business day convention, and</li>
                                            <li class="listbullet1" value="6">with no rounding of the result value.</li>
                                        </ul>
                                        <p class="bodytext"><strong class="boldcharstyle">Example 2</strong>
                                        </p>
                                        <p class="bodytext"><code class="monospace">AverageCommodityPrice("USD", "LME Zinc Closing Daily Market Rates","LME Zinc Closing Comm" ,"Zinc", "Pound", QueryStartDate, QueryEndDate, QueryPositionDate, QueryAsAtDate, 3, "DAYS", "DAILY", "MF", 0, "LINEAR", "FULL", "A", "MID", "United States|NZ", 5)</code>
                                        </p>
                                        <p class="bodytext">This example is similar to Example 1, except that:</p>
                                        <ul class="listbullet1">
                                            <li class="listbullet1" value="1">the <em class="emphasis">Term</em> and <em class="emphasis">TermType</em> specify 3 Days,</li>
                                            <li class="listbullet1" value="2">there are two Holiday Centers (United States and NZ),</li>
                                            <li class="listbullet1" value="3">the result is rounded (5/4) to 5 decimal places, and</li>
                                            <li class="listbullet1" value="4"><em class="emphasis">BDC</em> is <strong class="boldcharstyle">MF</strong> (Modified Following) meaning that holidays will be excluded (See <em class="emphasis">Note</em> above<strong class="boldcharstyle">**</strong>).</li>
                                        </ul>
                                    </div>
                                    <p>&#160;</p>
                                    <p>&#160;</p>
                                    <p>&#160;</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>